<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Insurance Plan Comparison Calculator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=Oswald:wght@200..700&display=swap" rel="stylesheet">
    <style>
        :root {
            --_color---primary--comic-relief-blue: #004be6;
            --_color---primary--party-pink: #f582ff;
            --_color---primary--apple-green: #14b900;
            --_color---primary--winter-green: #006950;
            --_color---primary--yellow: #f5d200;
            --_color---secondary--mint: #cdf0cd;
            --_color---secondary--sand: #f5d28c;
            --_color---primary--royal-purple: #4b3750;
            --_color---primary--hot-red: #f04132;
            --_color---primary--ice-blue: #33d6ff;
            --_color---primary--amber: #e69119;
            --_color---secondary--dark-grey: #a0a09c;
            --_color---secondary--bubblegum: #f5cdd2;
            --_color---primary--deep-red: #b40005;
            --_color---secondary--light-gray: #f0f0ee;
        } 
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            
        }
        
        body {
            font-family: "DM Sans",-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            padding: 20px;
            background-color: var(--_color---primary--comic-relief-blue);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
            border-radius: 12px;
        }
        
        h1, h2, h3, h4 {
            font-family: 'Oswald',"DM Sans",-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            text-transform: uppercase;
            line-height: 1;

        }
        h1 {
            margin-bottom: 30px;
            color: #fff;
            font-size: 4em;
        }
        
        h2 {
            margin-top: 0;
            margin-bottom: 20px;
            color: #444;
            font-size: 3em;
        }
        
        .section {
            padding: 20px;
            margin-bottom: 30px;
            background: #fff;
        }
    
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
        }
        
        .input-group label {
            margin-bottom: 5px;
            font-size: 14px;
            color: #555;
            font-weight: 500;
        }
        
        .input-group input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            font-size: 14px;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #2196F3;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }
        
        .plan-card {
            border: 1px solid #ddd;
            padding: 20px;
            background: white;
        }
        
        .plan-card.best {
            border: 3px solid var(--_color---primary--apple-green);
            background: #f1f8f4;
        }
        
        .plan-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .plan-name {
            font-size: 1.3em;
            font-weight: 600;
            color: #333;
        }
        
        .best-badge {
            background: var(--_color---primary--apple-green);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .plan-meta {
            font-size: 12px;
            color: #666;
            margin-bottom: 15px;
        }
        
        .hsa-badge {
            margin-left: 8px;
            padding: 2px 6px;
            background: var(--_color---secondary--light-gray);
            border-radius: 3px;
            font-size: 10px;
            font-weight: bold;
            color: var(--_color---primary--party-pink);
        }
        
        .total-cost {
            font-size: 32px;
            font-weight: bold;
            color: var(--_color---primary--comic-relief-blue);
            margin-bottom: 10px;
        }
        
        .total-cost .year {
            font-size: 16px;
            color: #666;
            font-weight: normal;
        }
        
        .cost-breakdown {
            border-top: 1px solid #eee;
            padding-top: 15px;
            font-size: 14px;
        }
        
        .cost-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .cost-row.small {
            font-size: 12px;
            color: #666;
        }
        
        .deductible-met {
            margin-top: 10px;
            padding: 8px;
            background: #fff3cd;
            border-radius: 4px;
            font-size: 12px;
            color: #856404;
        }
        
        .notes {
            margin-top: 30px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .notes ul {
            margin-top: 10px;
            margin-left: 20px;
        }
        
        .notes li {
            margin-bottom: 8px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Health Insurance Plan Comparison Calculator</h1>
        
        <!-- Assumed Costs Section -->
        <div class="section">
            <h2>Assumed Service Costs</h2>
            <p><i>Optional.</i> Estimates the healthcare costs without insurance; override the defaults if you know specifics.</p><br />
            <div class="grid" id="assumedCostsGrid"></div>
        </div>

        <!-- Usage Estimates Section -->
        <div class="section usage">
            <h2>Expected Annual Usage</h2>
            <p><b>Important!</b> Estimate how much healthcare you'll use.</p><br />
            <div class="grid" id="usageGrid"></div>
            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #ccc;">
                <div class="input-group" style="max-width: 300px;">
                    <label>Your Total Tax Rate (Federal + State + FICA) %</label>
                    <input type="number" id="taxRateInput" value="30" min="0" max="50" step="0.5">
                    <div style="font-size: 12px; color: #666; margin-top: 5px;">
                        HSA contributions reduce taxable income. FSA limited to $3,200/year.
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div>
            <h2>Plan Comparison Results</h2>
            <div class="results-grid" id="resultsGrid"></div>
        </div>

        <!-- Notes -->
        <div class="notes">
            <strong>ðŸ’¡ How This Works:</strong>
            <ul>
                <li><strong>HDHP Plans:</strong> Single deductible applies to all services, then copays/coinsurance kick in. HSA-eligible with unlimited tax-deductible contributions (up to IRS limits).</li>
                <li><strong>Copay Plans:</strong> Separate medical and Rx deductibles. Pay full cost until each deductible is met, then copays apply. FSA-eligible with $3,200 annual limit.</li>
                <li><strong>Tax Benefits:</strong> HSA/FSA contributions reduce taxable income. The calculator shows after-tax costs assuming you maximize available tax benefits.</li>
                <li>Premiums are semi-monthly (Ã—24 for annual total)</li>
                <li>All costs are capped at the out-of-pocket maximum</li>
                <li>Adjust "Assumed Service Costs" to match your plan's negotiated rates</li>
            </ul>
        </div>
    </div>

    <script>
        // Plan configurations
        const plans = [
            // HDHP Plans (HSA-eligible, single deductible)
            {
                name: 'HDHP 1700',
                type: 'HDHP',
                premium: 123.67,
                medDeductible: 1700,
                rxDeductible: 0,
                oopMax: 4500,
                primaryCopay: null,
                primaryCoinsurance: 10,
                specialistCopay: null,
                specialistCoinsurance: 10,
                urgentCareCopay: null,
                urgentCareCoinsurance: 10,
                erCopay: null,
                erCoinsurance: 10,
                rxGenericCopay: 10,
                rxBrandCopay: 35,
                rxTier3Copay: 60,
                rxTier4Copay: 120
            },
            {
                name: 'HDHP 3400',
                type: 'HDHP',
                premium: 50.65,
                medDeductible: 3400,
                rxDeductible: 0,
                oopMax: 7000,
                primaryCopay: null,
                primaryCoinsurance: 10,
                specialistCopay: null,
                specialistCoinsurance: 10,
                urgentCareCopay: null,
                urgentCareCoinsurance: 10,
                erCopay: null,
                erCoinsurance: 10,
                rxGenericCopay: 10,
                rxBrandCopay: 35,
                rxTier3Copay: 60,
                rxTier4Copay: 120
            },
            {
                name: 'HDHP 5000',
                type: 'HDHP',
                premium: 8.72,
                medDeductible: 5000,
                rxDeductible: 0,
                oopMax: 7150,
                primaryCopay: null,
                primaryCoinsurance: 20,
                specialistCopay: null,
                specialistCoinsurance: 20,
                urgentCareCopay: null,
                urgentCareCoinsurance: 20,
                erCopay: null,
                erCoinsurance: 20,
                rxGenericCopay: 10,
                rxBrandCopay: 35,
                rxTier3Copay: 60,
                rxTier4Copay: 120
            },
            // Primary Advantage Plans
            {
                name: 'Primary Advantage 2000',
                type: 'Copay',
                premium: 48.76,
                medDeductible: 2000,
                rxDeductible: 250,
                oopMax: 6500,
                primaryCopay: 0,
                primaryCoinsurance: null,
                specialistCopay: 100,
                specialistCoinsurance: null,
                urgentCareCopay: 50,
                urgentCareCoinsurance: null,
                erCopay: 250,
                erCoinsurance: 20,
                rxGenericCopay: 5,
                rxBrandCopay: 50,
                rxTier3Copay: 100,
                rxTier4Copay: 250
            },
            {
                name: 'Primary Advantage 4500',
                type: 'Copay',
                premium: 33.69,
                medDeductible: 4500,
                rxDeductible: 250,
                oopMax: 9200,
                primaryCopay: 0,
                primaryCoinsurance: null,
                specialistCopay: 100,
                specialistCoinsurance: null,
                urgentCareCopay: 50,
                urgentCareCoinsurance: null,
                erCopay: 250,
                erCoinsurance: 0,
                rxGenericCopay: 5,
                rxBrandCopay: 50,
                rxTier3Copay: 100,
                rxTier4Copay: 250
            },
            {
                name: 'Primary Advantage 5000',
                type: 'Copay',
                premium: 5.43,
                medDeductible: 5000,
                rxDeductible: 250,
                oopMax: 6500,
                primaryCopay: 0,
                primaryCoinsurance: null,
                specialistCopay: 100,
                specialistCoinsurance: null,
                urgentCareCopay: 50,
                urgentCareCoinsurance: null,
                erCopay: 250,
                erCoinsurance: 20,
                rxGenericCopay: 5,
                rxBrandCopay: 50,
                rxTier3Copay: 100,
                rxTier4Copay: 250
            },
            // Choice Plus Plans
            {
                name: 'Choice Plus 500/80',
                type: 'Copay',
                premium: 148.64,
                medDeductible: 500,
                rxDeductible: 150,
                oopMax: 5000,
                primaryCopay: 35,
                primaryCoinsurance: null,
                specialistCopay: 65,
                specialistCoinsurance: null,
                urgentCareCopay: 75,
                urgentCareCoinsurance: null,
                erCopay: 250,
                erCoinsurance: null,
                rxGenericCopay: 10,
                rxBrandCopay: 40,
                rxTier3Copay: 65,
                rxTier4Copay: 120
            },
            {
                name: 'Choice Plus 1000',
                type: 'Copay',
                premium: 136.86,
                medDeductible: 1000,
                rxDeductible: 150,
                oopMax: 5000,
                primaryCopay: 35,
                primaryCoinsurance: null,
                specialistCopay: 65,
                specialistCoinsurance: null,
                urgentCareCopay: 75,
                urgentCareCoinsurance: null,
                erCopay: 250,
                erCoinsurance: null,
                rxGenericCopay: 10,
                rxBrandCopay: 40,
                rxTier3Copay: 65,
                rxTier4Copay: 120
            },
            {
                name: 'Choice Plus 1500',
                type: 'Copay',
                premium: 114.72,
                medDeductible: 1500,
                rxDeductible: 150,
                oopMax: 6350,
                primaryCopay: 35,
                primaryCoinsurance: null,
                specialistCopay: 65,
                specialistCoinsurance: null,
                urgentCareCopay: 75,
                urgentCareCoinsurance: null,
                erCopay: 250,
                erCoinsurance: null,
                rxGenericCopay: 10,
                rxBrandCopay: 40,
                rxTier3Copay: 65,
                rxTier4Copay: 120
            },
            {
                name: 'Choice Plus 2500',
                type: 'Copay',
                premium: 83.63,
                medDeductible: 2500,
                rxDeductible: 150,
                oopMax: 6850,
                primaryCopay: 40,
                primaryCoinsurance: null,
                specialistCopay: 75,
                specialistCoinsurance: null,
                urgentCareCopay: 75,
                urgentCareCoinsurance: null,
                erCopay: 250,
                erCoinsurance: null,
                rxGenericCopay: 10,
                rxBrandCopay: 45,
                rxTier3Copay: 70,
                rxTier4Copay: 120
            },
            {
                name: 'Choice Plus 6000',
                type: 'Copay',
                premium: 58.19,
                medDeductible: 6000,
                rxDeductible: 200,
                oopMax: 8500,
                primaryCopay: 40,
                primaryCoinsurance: null,
                specialistCopay: 75,
                specialistCoinsurance: null,
                urgentCareCopay: 75,
                urgentCareCoinsurance: null,
                erCopay: 500,
                erCoinsurance: null,
                rxGenericCopay: 10,
                rxBrandCopay: 45,
                rxTier3Copay: 70,
                rxTier4Copay: 120
            }
        ];

        // Assumed service costs
        let assumedCosts = {
            primaryVisit: 200,
            specialistVisit: 300,
            urgentCare: 150,
            emergency: 2500,
            rxGeneric: 50,
            rxBrand: 200,
            rxTier3: 400,
            rxTier4: 800
        };

        // Usage estimates
        let usage = {
            primaryVisits: 2,
            specialistVisits: 1,
            urgentCare: 0,
            emergency: 0,
            rxGeneric: 12,
            rxBrand: 0,
            rxTier3: 0,
            rxTier4: 0
        };

        // Tax rate for HSA/FSA benefits
        let taxRate = 30; // percentage
        const FSA_LIMIT = 3200; // 2026 FSA contribution limit

        // Helper to format currency
        function formatCurrency(value) {
            return value.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        // Helper to convert camelCase to Title Case
        function toTitleCase(str) {
            return str.replace(/([A-Z])/g, ' $1').replace(/^./, s => s.toUpperCase());
        }

        // Calculate costs for a single plan
        function calculatePlanCost(plan) {
            const annualPremium = plan.premium * 24;
            
            let totalOOP = 0;
            let medDeductibleUsed = 0;
            let rxDeductibleUsed = 0;
            
            // Helper for HDHP plans
            function calculateHDHPServiceCost(quantity, fullCost, coinsuranceRate, copay = null) {
                let cost = 0;
                
                for (let i = 0; i < quantity; i++) {
                    const remaining = plan.medDeductible - medDeductibleUsed;
                    
                    if (remaining > 0) {
                        const deductiblePortion = Math.min(fullCost, remaining);
                        cost += deductiblePortion;
                        medDeductibleUsed += deductiblePortion;
                        
                        if (fullCost > deductiblePortion) {
                            const afterDeductible = fullCost - deductiblePortion;
                            cost += copay !== null ? copay : (afterDeductible * coinsuranceRate / 100);
                        }
                    } else {
                        cost += copay !== null ? copay : (fullCost * coinsuranceRate / 100);
                    }
                }
                
                return cost;
            }
            
            // Helper for Copay plans - Medical
            function calculateCopayPlanMedicalCost(quantity, fullCost, copay, coinsuranceRate = null) {
                let cost = 0;
                
                for (let i = 0; i < quantity; i++) {
                    const remaining = plan.medDeductible - medDeductibleUsed;
                    
                    if (remaining > 0) {
                        const deductiblePortion = Math.min(fullCost, remaining);
                        cost += deductiblePortion;
                        medDeductibleUsed += deductiblePortion;
                        
                        if (fullCost > deductiblePortion) {
                            if (copay !== null) {
                                cost += copay;
                            } else if (coinsuranceRate !== null) {
                                cost += (fullCost - deductiblePortion) * coinsuranceRate / 100;
                            }
                        }
                    } else {
                        if (copay !== null) {
                            cost += copay;
                        } else if (coinsuranceRate !== null) {
                            cost += fullCost * coinsuranceRate / 100;
                        }
                    }
                }
                
                return cost;
            }
            
            // Helper for Copay plans - Rx
            function calculateCopayPlanRxCost(quantity, fullCost, copay) {
                let cost = 0;
                
                for (let i = 0; i < quantity; i++) {
                    const remaining = plan.rxDeductible - rxDeductibleUsed;
                    
                    if (remaining > 0) {
                        const deductiblePortion = Math.min(fullCost, remaining);
                        cost += deductiblePortion;
                        rxDeductibleUsed += deductiblePortion;
                        
                        if (fullCost > deductiblePortion) {
                            cost += copay;
                        }
                    } else {
                        cost += copay;
                    }
                }
                
                return cost;
            }
            
            // Calculate based on plan type
            if (plan.type === 'HDHP') {
                totalOOP += calculateHDHPServiceCost(usage.primaryVisits, assumedCosts.primaryVisit, plan.primaryCoinsurance);
                totalOOP += calculateHDHPServiceCost(usage.specialistVisits, assumedCosts.specialistVisit, plan.specialistCoinsurance);
                totalOOP += calculateHDHPServiceCost(usage.urgentCare, assumedCosts.urgentCare, plan.urgentCareCoinsurance);
                totalOOP += calculateHDHPServiceCost(usage.emergency, assumedCosts.emergency, plan.erCoinsurance);
                totalOOP += calculateHDHPServiceCost(usage.rxGeneric, assumedCosts.rxGeneric, 0, plan.rxGenericCopay);
                totalOOP += calculateHDHPServiceCost(usage.rxBrand, assumedCosts.rxBrand, 0, plan.rxBrandCopay);
                totalOOP += calculateHDHPServiceCost(usage.rxTier3, assumedCosts.rxTier3, 0, plan.rxTier3Copay);
                totalOOP += calculateHDHPServiceCost(usage.rxTier4, assumedCosts.rxTier4, 0, plan.rxTier4Copay);
            } else {
                totalOOP += calculateCopayPlanMedicalCost(usage.primaryVisits, assumedCosts.primaryVisit, plan.primaryCopay, plan.primaryCoinsurance);
                totalOOP += calculateCopayPlanMedicalCost(usage.specialistVisits, assumedCosts.specialistVisit, plan.specialistCopay, plan.specialistCoinsurance);
                totalOOP += calculateCopayPlanMedicalCost(usage.urgentCare, assumedCosts.urgentCare, plan.urgentCareCopay, plan.urgentCareCoinsurance);
                totalOOP += calculateCopayPlanMedicalCost(usage.emergency, assumedCosts.emergency, plan.erCopay, plan.erCoinsurance);
                totalOOP += calculateCopayPlanRxCost(usage.rxGeneric, assumedCosts.rxGeneric, plan.rxGenericCopay);
                totalOOP += calculateCopayPlanRxCost(usage.rxBrand, assumedCosts.rxBrand, plan.rxBrandCopay);
                totalOOP += calculateCopayPlanRxCost(usage.rxTier3, assumedCosts.rxTier3, plan.rxTier3Copay);
                totalOOP += calculateCopayPlanRxCost(usage.rxTier4, assumedCosts.rxTier4, plan.rxTier4Copay);
            }
            
            totalOOP = Math.min(totalOOP, plan.oopMax);
            
            // Calculate tax savings
            let taxSavings = 0;
            if (plan.type === 'HDHP') {
                // HSA: tax savings on full OOP amount
                taxSavings = totalOOP * (taxRate / 100);
            } else {
                // FSA: tax savings capped at $3,200 limit
                const fsaContribution = Math.min(totalOOP, FSA_LIMIT);
                taxSavings = fsaContribution * (taxRate / 100);
            }
            
            return {
                premium: annualPremium,
                oop: totalOOP,
                total: annualPremium + totalOOP,
                taxSavings: taxSavings,
                afterTaxTotal: annualPremium + totalOOP - taxSavings,
                medDeductibleMet: medDeductibleUsed >= plan.medDeductible,
                medDeductibleUsed: medDeductibleUsed,
                rxDeductibleMet: plan.rxDeductible > 0 ? rxDeductibleUsed >= plan.rxDeductible : null,
                rxDeductibleUsed: plan.rxDeductible > 0 ? rxDeductibleUsed : null
            };
        }

        // Render assumed costs inputs
        function renderAssumedCosts() {
            const grid = document.getElementById('assumedCostsGrid');
            grid.innerHTML = '';
            
            Object.keys(assumedCosts).forEach(key => {
                const div = document.createElement('div');
                div.className = 'input-group';
                div.innerHTML = `
                    <label>${toTitleCase(key)}</label>
                    <input type="number" value="${assumedCosts[key]}" data-key="${key}" class="assumed-cost-input">
                `;
                grid.appendChild(div);
            });
            
            // Add event listeners
            document.querySelectorAll('.assumed-cost-input').forEach(input => {
                input.addEventListener('input', (e) => {
                    assumedCosts[e.target.dataset.key] = parseFloat(e.target.value) || 0;
                    renderResults();
                });
            });
        }

        // Render usage inputs
        function renderUsage() {
            const grid = document.getElementById('usageGrid');
            grid.innerHTML = '';
            
            Object.keys(usage).forEach(key => {
                const div = document.createElement('div');
                div.className = 'input-group';
                div.innerHTML = `
                    <label>${toTitleCase(key)}</label>
                    <input type="number" value="${usage[key]}" data-key="${key}" class="usage-input">
                `;
                grid.appendChild(div);
            });
            
            // Add event listeners
            document.querySelectorAll('.usage-input').forEach(input => {
                input.addEventListener('input', (e) => {
                    usage[e.target.dataset.key] = parseInt(e.target.value) || 0;
                    renderResults();
                });
            });
        }

        // Render results
        function renderResults() {
            const results = plans.map(plan => ({
                plan,
                costs: calculatePlanCost(plan)
            }));
            
            const bestPlan = results.reduce((best, current) => 
                current.costs.afterTaxTotal < best.costs.afterTaxTotal ? current : best
            );
            
            const grid = document.getElementById('resultsGrid');
            grid.innerHTML = '';
            
            results.forEach(({ plan, costs }) => {
                const isBest = costs.afterTaxTotal === bestPlan.costs.afterTaxTotal;
                
                const card = document.createElement('div');
                card.className = `plan-card ${isBest ? 'best' : ''}`;
                
                const deductibleInfo = plan.type === 'HDHP' 
                    ? `Deductible: $${plan.medDeductible.toLocaleString()}`
                    : `Med Ded: $${plan.medDeductible.toLocaleString()} | Rx Ded: $${plan.rxDeductible.toLocaleString()}`;
                
                const hsaBadge = plan.type === 'HDHP' 
                    ? '<span class="hsa-badge">HSA</span>' 
                    : '';
                
                const taxBenefitLabel = plan.type === 'HDHP' ? 'HSA Tax Savings' : 'FSA Tax Savings';
                
                let deductibleStatus = '';
                if (costs.medDeductibleMet) {
                    deductibleStatus = '<div class="deductible-met">âœ“ Med deductible met';
                    if (costs.rxDeductibleMet) {
                        deductibleStatus += ' â€¢ Rx deductible met';
                    }
                    deductibleStatus += '</div>';
                }
                
                const rxDeductibleRow = costs.rxDeductibleUsed !== null 
                    ? `<div class="cost-row small">
                        <span>Rx Deductible Used:</span>
                        <span>$${formatCurrency(costs.rxDeductibleUsed)}</span>
                    </div>`
                    : '';
                
                card.innerHTML = `
                    <div class="plan-header">
                        <div class="plan-name">${plan.name}</div>
                        ${isBest ? '<div class="best-badge">BEST VALUE</div>' : ''}
                    </div>
                    <div class="plan-meta">
                        ${deductibleInfo} | OOP Max: $${plan.oopMax.toLocaleString()}${hsaBadge}
                    </div>
                    <div class="total-cost">
                        $${formatCurrency(costs.afterTaxTotal)}
                        <span class="year">/yr</span>
                    </div>
                    <div class="cost-breakdown">
                        <div class="cost-row">
                            <span>Premium ($${plan.premium}/sm Ã— 24):</span>
                            <strong>$${formatCurrency(costs.premium)}</strong>
                        </div>
                        <div class="cost-row">
                            <span>Out-of-Pocket:</span>
                            <strong>$${formatCurrency(costs.oop)}</strong>
                        </div>
                        <div class="cost-row" style="color: var(--_color---primary--apple-green);">
                            <span>${taxBenefitLabel} (${taxRate}%):</span>
                            <strong>-$${formatCurrency(costs.taxSavings)}</strong>
                        </div>
                        <div class="cost-row small" style="padding-top: 8px; border-top: 1px solid #eee;">
                            <span style="font-weight: 600;">After-Tax Total:</span>
                            <span style="font-weight: 600;">$${formatCurrency(costs.afterTaxTotal)}</span>
                        </div>
                        <div class="cost-row small">
                            <span>Med Deductible Used:</span>
                            <span>$${formatCurrency(costs.medDeductibleUsed)}</span>
                        </div>
                        ${rxDeductibleRow}
                        ${deductibleStatus}
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        // Initial render
        renderAssumedCosts();
        renderUsage();
        renderResults();
        
        // Tax rate input listener
        document.getElementById('taxRateInput').addEventListener('input', (e) => {
            taxRate = parseFloat(e.target.value) || 0;
            renderResults();
        });
    </script>
</body>
</html>